{
    "name": "sav-malware-privacy-threat-bank-info-leakage",
    "match_rules": [
        {
            "key": "type",
            "val": "sav_malware"
        },
        {
            "key": "name",
            "val": "PrivacyThreat.BankInfoLeakage*"
        }
    ],
    "output": {
        "data": {
            "object_type": "behaviour",
            "object": {
                "ip": null,
                "clean_url": "",
                "blocked_url": "",
                "domain": "",
                "user_agent": "",
                "src_mac": null,
                "src_ip": null,
                "src_port": null,
                "dst_mac": "",
                "dst_ip": null,
                "dst_port": null,
                "detection": null,
                "lan_initiated": true
            },
            "threat_type": "privacy",
            "threat_subtype": "banking",
            "threat": null,
            "blocked": null
        },
        "metadata": {
            "target_mac": null,
            "target_ip": null,
            "device_id": null,
            "service": "connect/seccenter",
            "method": "report_malware",
            "data_name": "threats",
            "app_id": null
        }
    },
    "action_rules": [
        {
            "key": "data.object.clean_url",
            "val": "$extra.http_header_referer",
            "mandatory": false
        },
        {
            "key": "data.object.blocked_url",
            "val": "concatenate()",
            "params": ["$extra.http_host", "$extra.http_uri"],
            "mandatory": false
        },
        {
            "key": "data.object.domain",
            "val": "$extra.http_host",
            "mandatory": false
        },
        {
            "key": "data.object.user_agent",
            "val": "$extra.http_header_user_agent",
            "mandatory": false
        },
        {
            "key": "data.object.src_mac",
            "val": "$extra.src_mac",
            "mandatory": true
        },
        {
            "key": "data.object.src_ip",
            "val": "$extra.src_ip",
            "mandatory": true
        },
        {
            "key": "data.object.src_port",
            "val": "$extra.src_port",
            "mandatory": false
        },
        {
            "key": "data.object.dst_mac",
            "val": "$extra.dst_mac",
            "mandatory": false
        },
        {
            "key": ["data.object.dst_ip", "data.object.ip"],
            "val": "$extra.dst_ip",
            "mandatory": true
        },
        {
            "key": "data.object.dst_port",
            "val": "$extra.dst_port",
            "mandatory": false
        },
        {
            "key": "data.object.detection",
            "val": "concatenate()",
            "params": ["$type", ".", "$name"],
            "mandatory": true
        },
        {
            "key": "data.threat",
            "val": "$name",
            "mandatory": true
        },
        {
            "key": "data.blocked",
            "val": "was_blocked()",
            "params": ["$was_blocked"],
            "mandatory": true
        },
        {
            "key": "metadata.target_mac",
            "val": "$extra.src_mac",
            "mandatory": true
        },
        {
            "key": "metadata.target_ip",
            "val": "$extra.src_ip",
            "mandatory": true
        },
        {
            "key": "metadata.device_id",
            "val": "device_id()",
            "params": ["$extra.src_mac"],
            "mandatory": true
        },
        {
            "key": "metadata.app_id",
            "val": "app_id()",
            "params": [],
            "mandatory": true
        }
    ]
}
